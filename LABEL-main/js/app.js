

// Fonction pour nettoyer le nom du fichier
function cleanFileName(name) {
  return name.replace(/[\/:*?"<>|]/g, '_');  // Remplacer les caractères invalides par des underscores
}

async function generatePDF() {
  const { jsPDF } = window.jspdf;
  const JSZip = window.JSZip;

  // Récupérer les valeurs des champs
  const nomClient = document.getElementById('nom-client').value;  // Récupérer le nom du client
  const ficheClient = document.getElementById('fiche-client').value;
  const diagnostic = document.getElementById('diagnostic').value;
  const Facture = document.getElementById('Facture').value;
  const numeroSerieFiles = document.getElementById('numero-serie').files; // Récupérer tous les fichiers sélectionnés
  const panneFiles = document.getElementById('Panne-principal').files;  // Récupérer tous les fichiers sélectionnés
  const devisSigneFile = document.getElementById('devis-signe').files[0];  // Il n'y a qu'un fichier ici, donc on le récupère comme avant

  if (!nomClient || !ficheClient || !diagnostic || !numeroSerieFiles.length || !devisSigneFile || !Facture || !panneFiles.length) {
    alert('Veuillez remplir tous les champs avant de générer le PDF.');
    return;
  }
  const logoGaucheBase64 =
    "data:image/png;base64,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"
  const logoDroitBase64 =
    "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAACpCAYAAACRdwCqAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDcuMS1jMDAwIDc5LjljY2M0ZGU5MywgMjAyMi8wMy8xNC0xNDowNzoyMiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QTVGQTRGRDJGMDk2MTFFQzk3NEVDRDhDQzU1NjAzODkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QTVGQTRGRDFGMDk2MTFFQzk3NEVDRDhDQzU1NjAzODkiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIDIzLjMgKFdpbmRvd3MpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6QzUwQkIyMjZGMDc5MTFFQzk4QUVFNTEzNjNGQkQwMTciIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6QzUwQkIyMjdGMDc5MTFFQzk4QUVFNTEzNjNGQkQwMTciLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz6q2wY3AABBJ0lEQVR42uxd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"; // Remplacez par le Base64 de votre image à droite

  const pdf = new jsPDF();
  pdf.setTextColor(0, 0, 0); // Réinitialiser la couleur à noir pour les titres

  pdf.text('Fiche Client :', 10, 65);
  pdf.text('Diagnostic :', 10, 90);
  pdf.text('Facture :', 10, 115);

  const title = 'Rapport';

  let titleX = 80;  // Position horizontale (par exemple 70px depuis le bord gauche)
  let titleY = 42;  // Position verticale (par exemple 25px depuis le bord supérieur)



  const defaultFontSize = 12;  // Taille de police par défaut pour le reste du PDF
  pdf.setFontSize(34);  // Taille de police plus grande pour le titre
  pdf.setTextColor(0, 0, 0);  // Couleur noire pour le titre
  pdf.text(title, titleX, titleY);  // Ajouter le texte "Rapport" avec les coordonnées personnalisées
  pdf.setFontSize(defaultFontSize);  // Revenir à la taille de police par défaut

  pdf.setTextColor(0, 0, 255); // Couleur bleue pour les liens
  pdf.text(ficheClient, 10, 75);
  pdf.text(diagnostic, 10, 100);
  pdf.text(Facture, 10, 125);

  // Ajouter les liens cliquables dans le PDF
  pdf.link(10, 75, pdf.getTextWidth(ficheClient), 10, { url: ficheClient });
  pdf.link(10, 100, pdf.getTextWidth(diagnostic), 10, { url: diagnostic });
  pdf.link(10, 130, pdf.getTextWidth(Facture), 10, { url: Facture });

  // Ajouter des logos en haut à gauche et en haut à droite
  pdf.addImage(logoGaucheBase64, 'PNG', 10, 10, 40, 40); // Logo gauche
  pdf.addImage(logoDroitBase64, 'PNG', 160, 12, 40, 40); // Logo droit

  // Ajouter les titres des photos en noir
  pdf.setTextColor(0, 0, 0); // Réinitialiser la couleur à noir pour les titres des photos
  pdf.text('Photo du Numéro de Série :', 10, 500);
  pdf.text('PDF du Devis Signé :', 10, 500);
  pdf.text('Panne-principal :', 10, 500);

  // Fonction pour ajouter des images au PDF et au ZIP
  const addImageToPDFAndZip = async (file, x, y, width, height, zip, fileName) => {
    const reader = new FileReader();
    return new Promise((resolve, reject) => {
      reader.onload = (e) => {
        try {
          // Ajouter l'image au PDF
          pdf.addImage(e.target.result, 'JPEG', x, y, width, height);
          // Ajouter l'image au fichier ZIP
          zip.file(fileName, e.target.result.split('base64,')[1], { base64: true });
          resolve();
        } catch (error) {
          console.error(`Erreur lors de l'ajout de l'image ${fileName}:`, error);
          reject(error); // En cas d'erreur lors de l'ajout
        }
      };
      reader.onerror = (error) => {
        console.error(`Erreur de lecture du fichier ${fileName}:`, error);
        reject(error); // En cas d'erreur de lecture du fichier
      };
      reader.readAsDataURL(file);
    });
  };

  const zip = new JSZip();

  try {
    let xPosition = 10; // Position horizontale initiale
    let yPosition = 140; // Position verticale initiale
    const imageSpacing = 60; // Espacement horizontal entre les images

    // Ajout des images des numéros de série
    for (let i = 0; i < numeroSerieFiles.length && i < 3; i++) {
      await addImageToPDFAndZip(numeroSerieFiles[i], xPosition, yPosition, 40, 35, zip, `numeroSerie_${i + 1}.jpg`);
      pdf.text(`Photo Numéro de Série ${i + 1} :`, xPosition, yPosition - 5);
      xPosition += imageSpacing; // Décaler la position pour la prochaine image
    }

    // Réinitialisation des positions pour le prochain bloc
    xPosition = 10;
    yPosition += 50; // Décalage vertical pour les images des pannes

    // Ajout des images des pannes (jusqu'à 3)
    for (let i = 0; i < panneFiles.length && i < 3; i++) {
      await addImageToPDFAndZip(panneFiles[i], xPosition, yPosition, 40, 35, zip, `Panne_${i + 1}.jpg`);
      pdf.text(`Photo de la Panne ${i + 1} :`, xPosition, yPosition - 5);
      xPosition += imageSpacing; // Décaler la position pour la prochaine image
    }

    // Créer un Blob pour le premier PDF généré
    const pdfBlob = pdf.output('blob');

    // Créer un URL pour le premier PDF généré et l'afficher dans l'iframe
    const pdfUrl = URL.createObjectURL(pdfBlob);
    const pdfFrame = document.getElementById('pdf-frame');
    pdfFrame.src = pdfUrl; // Charger l'URL du premier PDF dans l'iframe

    // Ajout du devis signé dans une nouvelle page
    pdf.addPage(); // Ajouter une nouvelle page
    pdf.setFontSize(12);
    pdf.setTextColor(0, 0, 0); // Réinitialiser la couleur du texte en noir
    pdf.text('PDF du Devis Signé :', 10, 20); // Ajouter un titre pour la page

    const readerDevis = new FileReader();
    readerDevis.onload = async (e) => {
      try {
        // Créer un URL pour le PDF du devis signé et l'afficher dans l'iframe de la deuxième page
        const pdfData = e.target.result; // Contenu du fichier PDF signé
        const devisPdfUrl = URL.createObjectURL(new Blob([pdfData], { type: 'application/pdf' }));
        const pdfFrame = document.getElementById('pdf-frame');
        pdfFrame.src = pdfUrl;

        // Ajouter le fichier PDF signé dans le ZIP
        zip.file('DevisSigne.pdf', devisSigneFile, { base64: false });

        // Ajouter le premier fichier PDF (rapport) dans le ZIP
        zip.file('rapport.pdf', pdfBlob, { base64: false });

        const getFormattedDate = () => {
          const today = new Date();
          const day = String(today.getDate()).padStart(2, '0');
          const month = String(today.getMonth() + 1).padStart(2, '0');
          const year = today.getFullYear();
          return `${day}-${month}-${year}`;
        };

        const formattedDate = getFormattedDate();

        // Générer le fichier ZIP avec le nom du client et la date dans le nom
        zip.generateAsync({ type: 'blob' }).then(function(content) {
          const link = document.createElement('a');
          const safeClientName = cleanFileName(nomClient);  // Nettoyer le nom du client pour éviter les caractères invalides

          // Créer un Blob pour le ZIP et le télécharger
          const blob = new Blob([content], { type: 'application/zip' });
          const url = URL.createObjectURL(blob);
          link.href = url;
          link.download = `${safeClientName} ${formattedDate} Rapport.zip`;  // Inclure le nom du client et la date dans le nom du fichier

          // Déclencher le téléchargement
          document.body.appendChild(link);
          link.click();
          document.body.removeChild(link);
          URL.revokeObjectURL(url);  // Libérer l'URL de l'objet
        }).catch((error) => {
          console.error('Erreur lors de la génération du ZIP:', error);
          alert('Une erreur est survenue lors de la création du fichier ZIP.');
        });
      } catch (error) {
        console.error('Erreur lors du traitement du devis signé:', error);
        alert('Une erreur est survenue lors de l\'ajout du devis signé.');
      }
    };
    readerDevis.readAsArrayBuffer(devisSigneFile); // Charger le fichier PDF signé comme ArrayBuffer
  } catch (error) {
    console.error('Erreur:', error);
    alert('Une erreur est survenue lors de la génération du PDF.');
  }
}
